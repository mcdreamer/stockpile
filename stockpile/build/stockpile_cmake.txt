cmake_minimum_required(VERSION 3.0)

function(build_pile STOCKPILEBUILDDIR PILEDEFINITION PILEROOT PILEOUTPUT)

set(STOCKPILEPATH ${STOCKPILEBUILDDIR}/stockpile)

add_custom_command(
  OUTPUT ${PILEOUTPUT}
  DEPENDS ${CMAKE_CURRENT_BINARY_DIR}/${PILEDEFINITION};stockpile
  COMMENT ${STOCKPILEPATH}
  COMMAND ${STOCKPILEPATH} -i ${CMAKE_CURRENT_BINARY_DIR}/${PILEDEFINITION} -r ${CMAKE_CURRENT_BINARY_DIR}/${PILEROOT} -o ${PILEOUTPUT}
)

endfunction()
